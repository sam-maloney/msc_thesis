\chapter{Conclusion}
\label{chap:conclusion}

Simulations of physical phenomena involving stationary flows in the presence of external potential fields are encountered in many scientific domains, including weather and climate modelling and astrophysics, and many interesting problems for simulation require accurate resolution of the effects of small perturbations to these equilibria. Within astrophysics, standing accretion shocks (SAS) are a phenomenon of interest, and an instability (SASI) of such spherical shocks has been proposed as a potential component of the evolution of core-collapse supernovae. Since standard shock-capturing finite volume schemes can only resolve the equilibrium state to within the truncation error, it was desirable to develop a scheme to more accurately determine the equilibrium, such that perturbations which are similar to or smaller in scale than the truncation error on realistic meshes can be more efficiently simulated.

Extending on the well-balanced scheme for hydrostatic equilibria developed by KÃ¤ppeli and Mishra (KM14)~\cite{Kappeli2014}, a well-balanced scheme for equilibria with non-zero velocity in the presence of an external potential was developed and implemented. The principal component of the new method is a local equilibrium reconstruction scheme used to extend the cell average values of the finite volume scheme to the cell faces. It works by finding a quantity which remains constant under the given thermodynamic constraint for the problem, which for our example derivation was the Bernoulli constant for isentropic flows. Using this constant, the local change in the equilibrium primitive variables can be directly tied to the variation in the external potential, and second-order can be achieved by using a standard limited linear approximation for the deviation of the solution values from this computed local equilibrium. Completion of the well-balancing is then achieved by discretizing the source terms using a suitable differencing of these local equilibrium primitive values.

The method was implemented in the OpenFOAM C++ library, using the specific assumptions of an ideal gas equation of state and an isentropic flow; however, it is emphasized that the method itself is much more general, and specific implementations could easily be derived for other equations of state or thermodynamic constraints. As well, the current implementation was carried out so as to be suitable for both structured and unstructured grids, a first for this type of well-balanced scheme.

Numerical experiments were conducted to verify the method and implementation, starting with a series of 1D tests on a regular grid using a quintic polynomial external potential function. Simulations of the unperturbed equilibrium confirmed the machine precision accuracy of the new scheme for all grid resolutions compared to the expected first- or second-order truncation error for the unbalanced scheme. Further tests with varying amplitude perturbations on top of this equilibrium flow confirmed the expected convergence for the new scheme, and showed that for small perturbations, significantly coarser meshes could be used with the well-balanced scheme compared to the standard unbalanced scheme to achieve the same level of accuracy, which would make these new schemes much more computationally efficient, particularly as such savings would be compounded in higher dimensional simulations.

The 3D polytrope problem from KM14 was also simulated, here using an unstructured tetrahedral mesh to discretize the spherical domain of interest. Again, machine precision maintenance of the equilibrium flow was observed for the new scheme, confirming both the recovery of the hydrostatic equilibrium of the base method from KM14, as well as the successful extension of the well-balanced method to unstructured meshes, which can be very useful for simulations involving complex geometries not easily meshed using a regular structured grid.

As an application of this new scheme to study the possible underlying causes of the SASI, a simple model problem proposed by Foglizzo (F09)~\cite{Foglizzo2009} and Sato et al.\ (SFF09)~\cite{Sato2009} was simulated. This toy problem consists of a supersonic inflow incident on a stationary planar shock front, followed shortly by a potential step which decelerates the flow, intended to mimic the slowing of incoming matter as it reaches the accreting object. First the two sub-problems were run independently, separating the simulation of the shock and potential step, and the results compared very favourably to those from SFF09 and the analytic treatment of F09. After, the full toy problem was simulated, and showed clear evidence for the advective-acoustic cycle of perturbations in the interior region between the shock and potential step, which has been proposed as a possible driver of the SASI for non-planar shock geometries.
